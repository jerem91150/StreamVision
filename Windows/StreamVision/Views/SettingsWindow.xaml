<Window x:Class="StreamVision.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings"
        Height="600" Width="500"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterOwner">

    <Border CornerRadius="12" Background="#1A1A1A" BorderBrush="#333" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="#0D0D0D" Padding="24,16" CornerRadius="12,12,0,0"
                    MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Grid>
                    <TextBlock Text="Settings" FontSize="20" FontWeight="Bold" Foreground="White"/>
                    <Button HorizontalAlignment="Right" Click="Close_Click"
                            Background="Transparent" BorderThickness="0" Cursor="Hand">
                        <TextBlock Text="✕" FontSize="16" Foreground="#888"/>
                    </Button>
                </Grid>
            </Border>

            <!-- Content -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="24">
                <StackPanel>
                    <!-- Playback Settings -->
                    <TextBlock Text="PLAYBACK" FontSize="12" FontWeight="Bold" Foreground="#888" Margin="0,0,0,12"/>

                    <Border Background="#252525" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Buffer Size" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Network caching in milliseconds" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ComboBox Grid.Column="1" Width="120" SelectedIndex="2">
                                    <ComboBoxItem Content="1000 ms"/>
                                    <ComboBoxItem Content="2000 ms"/>
                                    <ComboBoxItem Content="3000 ms"/>
                                    <ComboBoxItem Content="5000 ms"/>
                                    <ComboBoxItem Content="10000 ms"/>
                                </ComboBox>
                            </Grid>

                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Hardware Acceleration" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Use GPU for video decoding" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ToggleButton x:Name="HwAccelToggle" IsChecked="True" Grid.Column="1"/>
                            </Grid>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Default Volume" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Initial volume level" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <Slider Grid.Column="1" Width="120" Minimum="0" Maximum="100" Value="100" VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- EPG Settings -->
                    <TextBlock Text="EPG (PROGRAM GUIDE)" FontSize="12" FontWeight="Bold" Foreground="#888" Margin="0,0,0,12"/>

                    <Border Background="#252525" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Auto-update EPG" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Refresh program guide automatically" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ToggleButton IsChecked="True" Grid.Column="1"/>
                            </Grid>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Update Interval" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Hours between updates" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ComboBox Grid.Column="1" Width="120" SelectedIndex="1">
                                    <ComboBoxItem Content="6 hours"/>
                                    <ComboBoxItem Content="12 hours"/>
                                    <ComboBoxItem Content="24 hours"/>
                                </ComboBox>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- TMDb Settings -->
                    <TextBlock Text="METADATA (TMDB)" FontSize="12" FontWeight="Bold" Foreground="#888" Margin="0,0,0,12"/>

                    <Border Background="#252525" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="API Key" FontSize="14" Foreground="White" Margin="0,0,0,8"/>
                            <TextBox x:Name="TmdbApiKeyBox" Background="#333" Foreground="White"
                                     BorderBrush="#444" Padding="12,10" FontSize="13"/>
                            <TextBlock Text="Get your free API key at themoviedb.org" FontSize="11" Foreground="#666" Margin="0,8,0,0"/>

                            <Grid Margin="0,16,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Auto-fetch metadata" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Get posters and info automatically" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ToggleButton IsChecked="True" Grid.Column="1"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Parental Controls -->
                    <TextBlock Text="CONTRÔLE PARENTAL" FontSize="12" FontWeight="Bold" Foreground="#888" Margin="0,0,0,12"/>

                    <Border Background="#252525" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Activer le contrôle parental" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Bloque l'accès aux contenus adultes" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ToggleButton x:Name="ParentalControlToggle" IsChecked="False" Grid.Column="1"
                                              Checked="ParentalControl_Toggled" Unchecked="ParentalControl_Toggled"/>
                            </Grid>

                            <Grid x:Name="PinSection" Visibility="Collapsed">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Code PIN" FontSize="14" Foreground="White"/>
                                    <TextBlock x:Name="PinStatusText" Text="Non configuré" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <Button x:Name="ChangePinBtn" Content="Configurer" Click="ChangePin_Click"
                                        Grid.Column="1" Padding="16,8"
                                        Background="#E94560" Foreground="White" BorderThickness="0" Cursor="Hand"/>
                            </Grid>

                            <StackPanel x:Name="BlockedCategoriesSection" Visibility="Collapsed" Margin="0,16,0,0">
                                <TextBlock Text="Catégories bloquées" FontSize="14" Foreground="White" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox x:Name="BlockAdultCheck" Content="Adulte / XXX" Foreground="#888" Margin="0,0,16,0"/>
                                    <CheckBox x:Name="BlockViolenceCheck" Content="Violence" Foreground="#888"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Interface Settings -->
                    <TextBlock Text="INTERFACE" FontSize="12" FontWeight="Bold" Foreground="#888" Margin="0,0,0,12"/>

                    <Border Background="#252525" CornerRadius="8" Padding="16">
                        <StackPanel>
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Start Fullscreen" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Launch in fullscreen mode" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ToggleButton IsChecked="False" Grid.Column="1"/>
                            </Grid>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Remember Last Channel" FontSize="14" Foreground="White"/>
                                    <TextBlock Text="Auto-play last watched on startup" FontSize="12" Foreground="#888"/>
                                </StackPanel>
                                <ToggleButton IsChecked="True" Grid.Column="1"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>

            <!-- Footer -->
            <Border Grid.Row="2" Background="#0D0D0D" Padding="24,16" CornerRadius="0,0,12,12">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Cancel" Click="Cancel_Click" Padding="24,10" Margin="0,0,12,0"
                            Background="#333" Foreground="White" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="Save" Click="Save_Click" Padding="24,10"
                            Background="#E50914" Foreground="White" BorderThickness="0" Cursor="Hand"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
